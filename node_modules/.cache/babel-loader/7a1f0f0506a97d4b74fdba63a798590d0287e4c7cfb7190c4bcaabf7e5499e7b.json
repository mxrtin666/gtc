{"ast":null,"code":"const USERS_STORAGE_KEY = 'gtc_users';\nconst TRANSACTIONS_STORAGE_KEY = 'gtc_transactions';\nfunction readJsonStorage(key) {\n  try {\n    const raw = localStorage.getItem(key);\n    if (!raw) {\n      return [];\n    }\n    const parsed = JSON.parse(raw);\n    return Array.isArray(parsed) ? parsed : [];\n  } catch (error) {\n    console.error(`Failed to read ${key} from localStorage`, error);\n    return [];\n  }\n}\nfunction writeJsonStorage(key, value) {\n  localStorage.setItem(key, JSON.stringify(value));\n}\nasync function loadJsonFile(path) {\n  try {\n    const response = await fetch(path);\n    if (!response.ok) {\n      console.error(`Failed to load ${path}`);\n      return [];\n    }\n    const data = await response.json();\n    return Array.isArray(data) ? data : [];\n  } catch (error) {\n    console.error(`Error loading ${path}`, error);\n    return [];\n  }\n}\nfunction mergeById(baseRows, localRows) {\n  const byId = new Map();\n  baseRows.forEach(row => {\n    byId.set(row.id, row);\n  });\n  localRows.forEach(row => {\n    byId.set(row.id, row);\n  });\n  return Array.from(byId.values());\n}\nexport async function loadUsers() {\n  const jsonUsers = await loadJsonFile('/data/users.json');\n  const localUsers = readJsonStorage(USERS_STORAGE_KEY);\n  return mergeById(jsonUsers, localUsers);\n}\nexport function saveUser(user) {\n  const users = readJsonStorage(USERS_STORAGE_KEY);\n  users.push(user);\n  writeJsonStorage(USERS_STORAGE_KEY, users);\n}\nexport async function loadTransactions() {\n  const jsonTransactions = await loadJsonFile('/data/transactions.json');\n  const localTransactions = readJsonStorage(TRANSACTIONS_STORAGE_KEY);\n  return mergeById(jsonTransactions, localTransactions).sort((a, b) => {\n    return new Date(b.transactionDate) - new Date(a.transactionDate);\n  });\n}\nexport function saveTransaction(transaction) {\n  const transactions = readJsonStorage(TRANSACTIONS_STORAGE_KEY);\n  transactions.push(transaction);\n  writeJsonStorage(TRANSACTIONS_STORAGE_KEY, transactions);\n}","map":{"version":3,"names":["USERS_STORAGE_KEY","TRANSACTIONS_STORAGE_KEY","readJsonStorage","key","raw","localStorage","getItem","parsed","JSON","parse","Array","isArray","error","console","writeJsonStorage","value","setItem","stringify","loadJsonFile","path","response","fetch","ok","data","json","mergeById","baseRows","localRows","byId","Map","forEach","row","set","id","from","values","loadUsers","jsonUsers","localUsers","saveUser","user","users","push","loadTransactions","jsonTransactions","localTransactions","sort","a","b","Date","transactionDate","saveTransaction","transaction","transactions"],"sources":["/Users/mxrtin/Documents/gtc/src/services/dataStore.js"],"sourcesContent":["const USERS_STORAGE_KEY = 'gtc_users';\nconst TRANSACTIONS_STORAGE_KEY = 'gtc_transactions';\n\nfunction readJsonStorage(key) {\n  try {\n    const raw = localStorage.getItem(key);\n    if (!raw) {\n      return [];\n    }\n    const parsed = JSON.parse(raw);\n    return Array.isArray(parsed) ? parsed : [];\n  } catch (error) {\n    console.error(`Failed to read ${key} from localStorage`, error);\n    return [];\n  }\n}\n\nfunction writeJsonStorage(key, value) {\n  localStorage.setItem(key, JSON.stringify(value));\n}\n\nasync function loadJsonFile(path) {\n  try {\n    const response = await fetch(path);\n    if (!response.ok) {\n      console.error(`Failed to load ${path}`);\n      return [];\n    }\n    const data = await response.json();\n    return Array.isArray(data) ? data : [];\n  } catch (error) {\n    console.error(`Error loading ${path}`, error);\n    return [];\n  }\n}\n\nfunction mergeById(baseRows, localRows) {\n  const byId = new Map();\n  baseRows.forEach((row) => {\n    byId.set(row.id, row);\n  });\n  localRows.forEach((row) => {\n    byId.set(row.id, row);\n  });\n  return Array.from(byId.values());\n}\n\nexport async function loadUsers() {\n  const jsonUsers = await loadJsonFile('/data/users.json');\n  const localUsers = readJsonStorage(USERS_STORAGE_KEY);\n  return mergeById(jsonUsers, localUsers);\n}\n\nexport function saveUser(user) {\n  const users = readJsonStorage(USERS_STORAGE_KEY);\n  users.push(user);\n  writeJsonStorage(USERS_STORAGE_KEY, users);\n}\n\nexport async function loadTransactions() {\n  const jsonTransactions = await loadJsonFile('/data/transactions.json');\n  const localTransactions = readJsonStorage(TRANSACTIONS_STORAGE_KEY);\n\n  return mergeById(jsonTransactions, localTransactions).sort((a, b) => {\n    return new Date(b.transactionDate) - new Date(a.transactionDate);\n  });\n}\n\nexport function saveTransaction(transaction) {\n  const transactions = readJsonStorage(TRANSACTIONS_STORAGE_KEY);\n  transactions.push(transaction);\n  writeJsonStorage(TRANSACTIONS_STORAGE_KEY, transactions);\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}